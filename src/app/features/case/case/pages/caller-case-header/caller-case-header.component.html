<div class="caller-container">
  <div class="call-ref">
    <p>
      Case Reference Number: {{ caseRef || "N/A" }}
      <span class="status">(Opened)</span>
    </p>

    <div class="btn-row">
      <button (click)="openModal('contactHistory')">Contact History</button>
      <button (click)="openModal('additionalCost')">Additional Cost</button>
      <button (click)="openModal('abort')">Abort</button>
      <button (click)="openModal('caseRating')">Case rating</button>
      <button (click)="openModal('phaseCosting')">phase costing</button>
      <button (click)="openModal('exit')">Exit</button>
      <button (click)="openModal('sms')">SMS</button>
      <button (click)="openModal('email')">Send Email</button>
    </div>
  </div>
</div>

<!-- One lightweight modal reused for all actions -->
<div class="modal-backdrop" *ngIf="activeModal" (click)="closeModal()">
  <div class="modal-card" role="dialog" aria-modal="true" (click)="$event.stopPropagation()">
    <header class="modal-header">
      <h3>{{ activeModal ? modalTitleMap[activeModal] : '' }}</h3>
      <button type="button" class="icon-btn" (click)="closeModal()" aria-label="Close">âœ•</button>
    </header>

    <section class="modal-body">
      <div *ngIf="mounted.contactHistory" [hidden]="activeModal !== 'contactHistory'">
        <app-contact-history [caseRef]="caseRef"></app-contact-history>
      </div>

      <div *ngIf="mounted.additionalCost" [hidden]="activeModal !== 'additionalCost'">
        <app-additional-costing></app-additional-costing>
      </div>

      <div *ngIf="mounted.caseRating" [hidden]="activeModal !== 'caseRating'">
        <app-call-rating-ss2></app-call-rating-ss2>
      </div>

      <div *ngIf="mounted.phaseCosting" [hidden]="activeModal !== 'phaseCosting'">
        <app-phase-costing></app-phase-costing>
      </div>

      <div *ngIf="mounted.abort" [hidden]="activeModal !== 'abort'">
        <app-abort></app-abort>
      </div>

      <div *ngIf="mounted.exit" [hidden]="activeModal !== 'exit'">
        <app-exit></app-exit>
      </div>

      <div *ngIf="mounted.sms" [hidden]="activeModal !== 'sms'">
        <app-sms [caseRef]="caseRef"></app-sms>
      </div>

      <div *ngIf="mounted.email" [hidden]="activeModal !== 'email'">
        <app-email [caseRef]="caseRef"></app-email>
      </div>
    </section>
  </div>
</div>